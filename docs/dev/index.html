<!doctype html>
<meta charset=utf-8>
<title>microdoc</title>
<meta name=description content="Minimalist zero-config zero-build project documentation web apps.">
<meta name=viewport content="width=device-width">
<link href=favicon.svg rel=icon>
<!-- <link href=https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-okaidia.min.css rel=stylesheet> -->
<!-- <link href=https://cdn.jsdelivr.net/npm/prism-themes@1/themes/prism-one-dark.min.css rel=stylesheet> -->
<!-- <link href=https://cdn.jsdelivr.net/npm/prism-themes@1/themes/prism-dracula.min.css rel=stylesheet> -->
<!-- <link href=https://cdn.jsdelivr.net/npm/prism-themes@1/themes/prism-ghcolors.min.css rel=stylesheet> -->
<link href=/dev/node_modules/microdoc/microdoc.css rel=stylesheet>
<!-- <script src=https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js defer></script>
<script src=https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js defer></script> -->
<script src=/dev/node_modules/microdoc/microdoc.js defer></script>
<script src=/dev/node_modules/microdoc/plugin/search.js defer></script>
<!-- <script src=/dev/node_modules/microdoc/plugin/preload.js defer></script> -->
<script src=/dev/node_modules/microdoc/plugin/prevnext.js defer></script>
<script src=/dev/node_modules/microdoc/plugin/code.js defer></script>
<!-- <style>.microdoc-sidebar-wrapper{display:none}.microdoc-main{width:100%}</style> -->
<script>
  var microdoc = {
    // root: ".",
    routes: [
      "introduction.md",
      "getting-started.md",
      { path: "plugins", children: [
        "search.md",
        { name: 'PrevNext', path: "prevnext.md" },
        "code.md",
        "preload.md"
      ]},
      { path: "advanced", children: [
        "development.md"
      ]},
      { path: "dev", children: [
        "temp-md-1.md",
        "temp-md-2.md",
        "temp-md-3.md",
        "temp-md-4.md",
        "404.md"
      ]}
    ]
  }
</script>
<noscript>You need to enable JavaScript to run this app.</noscript>

<style>
  .ml3 { margin-left: 1rem; }
</style>
<script>
  function ready(fn){"loading"!==document.readyState?fn():document.addEventListener("DOMContentLoaded",fn)}

  // document.addEventListener('microdoc-loaded', () => Prism.highlightAll());

  function headerExtra() {
    const root = document.createElement("div");
    // const link = document.createElement("a");
    const btn = document.createElement("button");
    // root.classList = "ml-auto";
    // link.href = "https://github.com/maxmilton/ekscss";
    // link.textContent = "github";
    btn.textContent = "Load File/Dir";
    btn.classList = "ml3 mv-1"
    btn.__click = fileLoader;
    // root.append(link, btn);
    root.append(btn);
    return root;
  }

  ready(() => {
    window.microdoc.append(headerExtra(), document.querySelector(".microdoc-header"));
  })

  // XXX: Only works in Chrome and Edge (but not Brave)
  // https://web.dev/file-system-access/
  // https://github.com/GoogleChromeLabs/text-editor/blob/main/src/inline-scripts/fs-helpers.js
  // https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API
  // https://developer.mozilla.org/en-US/docs/Web/API/Window/showOpenFilePicker
  async function fileLoader() {
    const [handle] = await window.showOpenFilePicker({
      types: [{
        accept: { "text/*": [".md", ".txt", ".html"] },
        description: "Markdown, HTML, or plain text",
      }],
    });

    if (!handle) {
      // User cancelled, or otherwise failed to open a file
      return;
    }

    if (handle.kind === "directory") {
      // TODO: Handle dirs; dynamically populate routes + load first
      console.log("DIR NAME", handle.name);
      return;
    }

    const file = await handle.getFile();
    const contents = await file.text();

    // TODO: Render etc.
    console.log("FILE CONTENTS", contents);
  }
</script>
